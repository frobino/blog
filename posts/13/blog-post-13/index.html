<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NAS with Samba.</title>
    <meta name="Description" content="NAS with Samba.">
    <!-- custom css, for style which is NOT present in the w3.css -->
    <link rel="stylesheet" href="/blog/css/custom.css">
    <!-- custom css used for eleventy language plugin -->
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="Francesco&#39;s Blog">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Verdana">
    <!-- css below is currently used only for hamburger button -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <style>
    body,h1,h2,h3,h4,h5,h6 {font-family: "Verdana", sans-serif; font-size: 120%;}
  </style>
  <body class="w3-light-grey">

    <!-- Navbar on medium and large screens (Hidden on small screens) -->
    <div class="w3-top">
      <div class="w3-bar w3-black w3-card">
        <a class="w3-bar-item w3-button w3-padding-large w3-hide-medium w3-hide-large w3-right" href="javascript:void(0)" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
        <a href="/blog/" class="w3-bar-item w3-button w3-padding-large">Francesco&#39;s Blog</a>
        <div class="w3-right">
          <a href="/blog/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">Home</a>
          <a href="/blog/posts/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">Archive</a>
          <a href="/blog/pages/about/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">About Me</a>
          <a href="/blog/pages/search/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">Search</a>
        </div>
      </div>
    </div>

    <!-- Navbar on small screens (remove the onclick attribute if you want the navbar to always show on top of the content when clicking on the links) -->
    <div id="navDemo" class="w3-bar-block w3-black w3-hide w3-hide-large w3-hide-medium w3-top" style="margin-top:46px">
      <a href="/blog/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">Home</a>
      <a href="/blog/posts/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">Archive</a>
      <a href="/blog/pages/about/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">About Me</a>
      <a href="/blog/pages/search/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">Search</a>
    </div>

    <main class="tmpl-post w3-padding-64">
      <!--
      <div class="warning">
        <ol>
          <li>Edit the <code>_data/metadata.json</code> with your blogâ€™s information.</li>
          <li>(Optional) Edit <code>.eleventy.js</code> with your <a href="https://www.11ty.dev/docs/config/">configuration preferences</a>.</li>
          <li>Delete this message from <code>_includes/layouts/base.njk</code>.</li>
        </ol>
        <p><em>This is an <a href="https://www.11ty.io/">Eleventy project</a> created from the <a href="https://github.com/11ty/eleventy-base-blog"><code>eleventy-base-blog</code> repo</a>.</em></p>
      </div>
      -->

      <h1>NAS with Samba.</h1>

<h2>How to format disk to exFAT.</h2>
<p>See <a href="https://linuxconfig.org/how-to-format-usb-with-exfat-on-linux">this tutorial</a>. Uses gdisk and mkfs cli tools.</p>
<pre><code>sudo apt install exfuse
sudo apt install exfat-fuse
sudo gparted
sudo gdisk /dev/sdb
sudo mkfs -t exfat /dev/sdb1 
sudo mkfs -t exfat /dev/sdb2 
</code></pre>
<h2>Install and configure Samba</h2>
<p>Mount the disks that will be used to store the data:</p>
<pre><code># The umask parameter is needed for exfat to be mounted as 755
sudo mount /dev/sdb1 /media/bbib/4680-EF03 -o umask=0000
</code></pre>
<p>Install Samba:</p>
<pre><code>sudo apt update
sudo apt install samba
sudo cp /etc/samba/smb.comf /etc/samba/smb.comf.bak
sudo cp /etc/samba/smb.conf /etc/samba/smb.conf.bak
sudo emacs /etc/samba/smb.conf&amp;
</code></pre>
<p>Edit the conf file adding the following configuration, where</p>
<pre><code>[sda1]
path = /home/bbib/samba/
Browseable = yes
Writeable = Yes
only guest = no
create mask = 0777
directory mask = 0777
Public = no
Guest ok = no
valid users = frallan

[sdb1]
path = /home/bbib/samba-usb/
Browseable = yes
Writeable = Yes
only guest = no
create mask = 0777
directory mask = 0777
Public = no
Guest ok = no
valid users = frallan
</code></pre>
<p>Add the user that will be used to access the disks:</p>
<pre><code>sudo adduser frallan
sudo smbpasswd -a frallan
sudo systemctl restart smbd
</code></pre>
<p>If needed, users can be removed:</p>
<pre><code>sudo smbpasswd -x frallan
</code></pre>
<h2>Use a app to access the NAS:</h2>
<p>For example <em>Cx File Explorer</em></p>


<p><a href="/blog/">Home</a></p>


    </main>

    <footer></footer>

    <!-- Current page: /blog/posts/13/blog-post-13/ -->

    <script>
      // Used to toggle the menu on small screens when clicking on the menu button
      function myFunction() {
        var x = document.getElementById("navDemo");
        if (x.className.indexOf("w3-show") == -1) {
          x.className += " w3-show";
        } else { 
          x.className = x.className.replace(" w3-show", "");
        }
      }
    </script>

  </body>
</html>
