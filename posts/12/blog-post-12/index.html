<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minikube tutorial.</title>
    <meta name="Description" content="Minikube tutorial.">
    <!-- custom css, for style which is NOT present in the w3.css -->
    <link rel="stylesheet" href="/blog/css/custom.css">
    <!-- custom css used for eleventy language plugin -->
    <link rel="stylesheet" href="/blog/css/prism-base16-monokai.dark.css">
    <link rel="alternate" href="/blog/feed/feed.xml" type="application/atom+xml" title="Francesco&#39;s Blog">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Verdana">
    <!-- css below is currently used only for hamburger button -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  </head>
  <style>
    body,h1,h2,h3,h4,h5,h6 {font-family: "Verdana", sans-serif; font-size: 120%;}
  </style>
  <body class="w3-light-grey">

    <!-- Navbar on medium and large screens (Hidden on small screens) -->
    <div class="w3-top">
      <div class="w3-bar w3-black w3-card">
        <a class="w3-bar-item w3-button w3-padding-large w3-hide-medium w3-hide-large w3-right" href="javascript:void(0)" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
        <a href="/blog/" class="w3-bar-item w3-button w3-padding-large">Francesco&#39;s Blog</a>
        <div class="w3-right">
          <a href="/blog/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">Home</a>
          <a href="/blog/posts/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">Archive</a>
          <a href="/blog/pages/about/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">About Me</a>
          <a href="/blog/pages/search/" class="w3-bar-item w3-button w3-padding-large w3-hide-small">Search</a>
        </div>
      </div>
    </div>

    <!-- Navbar on small screens (remove the onclick attribute if you want the navbar to always show on top of the content when clicking on the links) -->
    <div id="navDemo" class="w3-bar-block w3-black w3-hide w3-hide-large w3-hide-medium w3-top" style="margin-top:46px">
      <a href="/blog/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">Home</a>
      <a href="/blog/posts/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">Archive</a>
      <a href="/blog/pages/about/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">About Me</a>
      <a href="/blog/pages/search/" class="w3-bar-item w3-button w3-padding-large" onclick="myFunction()">Search</a>
    </div>

    <main class="tmpl-post w3-padding-64">
      <!--
      <div class="warning">
        <ol>
          <li>Edit the <code>_data/metadata.json</code> with your blogâ€™s information.</li>
          <li>(Optional) Edit <code>.eleventy.js</code> with your <a href="https://www.11ty.dev/docs/config/">configuration preferences</a>.</li>
          <li>Delete this message from <code>_includes/layouts/base.njk</code>.</li>
        </ol>
        <p><em>This is an <a href="https://www.11ty.io/">Eleventy project</a> created from the <a href="https://github.com/11ty/eleventy-base-blog"><code>eleventy-base-blog</code> repo</a>.</em></p>
      </div>
      -->

      <h1>Minikube tutorial.</h1>

<h2>Install minikube</h2>
<pre><code>mkdir Tools_installation_files
cd Tools_installation_files/
curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
sudo install minikube-linux-amd64 /usr/local/bin/minikube
</code></pre>
<h2>Install docker (dependency for minikube)</h2>
<pre><code>sudo apt-get install     ca-certificates     curl     gnupg     lsb-release
sudo mkdir -m 0755 -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
echo   &quot;deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/debian \
  $(lsb_release -cs) stable&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
minikube start
sudo usermod -aG docker $USER
newgrp docker
</code></pre>
<h2>Start minikube</h2>
<pre><code>minikube start
minikube kubectl -- get po -A
emacs ~/.bashrc
minikube stop
kubectl get all
</code></pre>
<h2>Reset minikube</h2>
<pre><code>minikube delete --all
</code></pre>
<h2>Install ArgoCD</h2>
<pre><code>kubectl get services -A
minikube delete --all
minikube start
kubectl create namespace argocd
kubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
$ kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=&quot;{.data.password}&quot; | base64 -d; echo
kubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=&quot;{.data.password}&quot; | base64 -d; echo
kubectl port-forward svc/argocd-server -n argocd 8080:443
kubectl create namespace argocd-apps
</code></pre>
<h2>Create and start a POD</h2>
<pre><code>minikube start
kubectl get pods
kubectl get services
kubectl run my-ng1 --image=nginx --restart=Never
kubectl get pods
kubectl exec --stdin --tty my-ng1 -- /bin/bash
touch rbac.yaml
emacs rbac.yaml
kubectl apply -f rbac.yaml
kubectl exec --stdin --tty my-ng1 -- /bin/bash
</code></pre>
<h2>Enable a pod in a namespace to create pods in another namespace</h2>
<pre><code>kubectl create namespace spawner
kubectl create namespace pool
kubectl apply -f rbac.yaml (read/write auth to spawner)
kubectl get clusterrole
kubectl exec --stdin --tty my-ng1 -n spawner -- /bin/bash
kubectl get pods
kubectl get pods -n spawner
kubectl get pods -n pool
kubectl delete pod busybox-test -n pool
kubectl get pods -n pool
</code></pre>


<p><a href="/blog/">Home</a></p>


    </main>

    <footer></footer>

    <!-- Current page: /blog/posts/12/blog-post-12/ -->

    <script>
      // Used to toggle the menu on small screens when clicking on the menu button
      function myFunction() {
        var x = document.getElementById("navDemo");
        if (x.className.indexOf("w3-show") == -1) {
          x.className += " w3-show";
        } else { 
          x.className = x.className.replace(" w3-show", "");
        }
      }
    </script>

  </body>
</html>
